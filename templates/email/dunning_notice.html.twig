{% extends 'email/base.html.twig' %}

{% block title %}{{ 'email.dunning_notice.title'|trans }}{% endblock %}

{% block stylesheets %}
    <style>
        .header { background: #DC2626; }
        .warning { background: #FEE2E2; border-left: 4px solid #DC2626; padding: 15px; margin: 20px 0; }
        .button { background: #DC2626; }
        [dir="rtl"] .warning { border-left: none; border-right: 4px solid #DC2626; }
    </style>
{% endblock %}

{% block content %}
    <p>{{ 'email.dunning_notice.greeting'|trans({'%email%': user.email}) }},</p>
    
    <div class="warning">
        <strong>{{ 'email.dunning_notice.warning'|trans }}</strong>
    </div>
    
    <p>{{ 'email.dunning_notice.message'|trans({'%team%': team.name, '%plan%': subscription.plan.name}) }}</p>
    
    <p><strong>{{ 'email.dunning_notice.retry_status'|trans }}:</strong></p>
    <ul>
        <li>{{ 'email.dunning_notice.attempt'|trans }}: {{ retry_count }} {{ 'email.dunning_notice.of'|trans }} 3</li>
        <li>{{ 'email.dunning_notice.retries_remaining'|trans }}: {{ retries_remaining }}</li>
        {% if grace_period_ends_at %}
        <li>{{ 'email.dunning_notice.grace_period'|trans }}: {{ grace_period_ends_at|date('M d, Y') }}</li>
        {% endif %}
    </ul>
    
    {% if retries_remaining > 0 %}
    <p>{{ 'email.dunning_notice.retry_info'|trans }}</p>
    {% else %}
    <p><strong>{{ 'email.dunning_notice.final_notice'|trans }}:</strong> {{ 'email.dunning_notice.final_notice_msg'|trans }}</p>
    {% endif %}
    
    <div style="text-align: center;">
        <a href="{{ url('payment_methods') }}" class="button">{{ 'email.dunning_notice.button'|trans }}</a>
    </div>
    
    <p><strong>{{ 'email.dunning_notice.consequences.title'|trans }}</strong></p>
    <ul>
        <li>{{ 'email.dunning_notice.consequences.1'|trans({'%count%': retries_remaining}) }}</li>
        <li>{{ 'email.dunning_notice.consequences.2'|trans }}</li>
        <li>{{ 'email.dunning_notice.consequences.3'|trans({'%plan%': subscription.plan.name}) }}</li>
    </ul>
    
    <p>{{ 'email.dunning_notice.help'|trans }}</p>
{% endblock %}
