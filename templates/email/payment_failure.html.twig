{% extends 'email/base.html.twig' %}

{% block title %}{{ 'email.payment_failure.title'|trans }}{% endblock %}

{% block stylesheets %}
    <style>
        .header { background: #DC2626; }
        .alert { background: #FEE2E2; border-left: 4px solid #DC2626; padding: 15px; margin: 20px 0; }
        .button { background: #DC2626; }
        [dir="rtl"] .alert { border-left: none; border-right: 4px solid #DC2626; }
    </style>
{% endblock %}

{% block content %}
    <p>{{ 'email.payment_failure.greeting'|trans({'%email%': user.email}) }},</p>
    
    <div class="alert">
        <strong>{{ 'email.payment_failure.action_required'|trans }}:</strong> {{ 'email.payment_failure.message'|trans({'%team%': team.name}) }}
    </div>
    
    <p><strong>{{ 'email.payment_failure.reason'|trans }}:</strong> {{ payment.failureReason ?? 'email.payment_failure.default_reason'|trans }}</p>
    
    <p><strong>{{ 'email.payment_failure.plan'|trans }}:</strong> {{ subscription.plan.name }} ({{ subscription.plan.formattedPrice }})</p>
    
    {% if retry_count < 3 %}
    <p>{{ 'email.payment_failure.retry_info'|trans }}</p>
    
    <p><strong>{{ 'email.payment_failure.retry_attempt'|trans }}:</strong> {{ retry_count }} {{ 'email.payment_failure.of'|trans }} 3</p>
    {% else %}
    <p>{{ 'email.payment_failure.final_attempt_info'|trans }}</p>
    {% endif %}
    
    <div style="text-align: center;">
        <a href="{{ url('payment_methods') }}" class="button">{{ 'email.payment_failure.button'|trans }}</a>
    </div>
    
    <p><strong>{{ 'email.payment_failure.next_steps.title'|trans }}</strong></p>
    <ul>
        <li>{{ 'email.payment_failure.next_steps.1'|trans }}</li>
        <li>{{ 'email.payment_failure.next_steps.2'|trans }}</li>
        <li>{{ 'email.payment_failure.next_steps.3'|trans }}</li>
    </ul>
    
    <p>{{ 'email.contact_support'|trans }}</p>
{% endblock %}
